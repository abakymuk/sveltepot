# Настройка проекта SveltePot

## Требования

- Node.js LTS (версия указана в `.nvmrc`)
- pnpm (рекомендуется последняя версия)

## Установка и запуск

1. **Установка зависимостей:**

   ```bash
   pnpm install
   ```

2. **Запуск в режиме разработки:**
   ```bash
   pnpm dev
   ```
   Приложение будет доступно по адресу: http://localhost:5173

## Команды разработки

### Основные команды

- `pnpm dev` - запуск сервера разработки
- `pnpm build` - сборка проекта для продакшена
- `pnpm preview` - предварительный просмотр собранного проекта

### Качество кода

- `pnpm lint` - проверка кода с помощью ESLint
- `pnpm format` - форматирование кода с помощью Prettier
- `pnpm typecheck` - проверка типов TypeScript и Svelte

### Тестирование

- `pnpm test:unit` - запуск unit-тестов
- `pnpm test:e2e` - запуск end-to-end тестов
- `pnpm test` - запуск всех тестов

### База данных

- `pnpm db:push` - отправка схемы в базу данных
- `pnpm db:generate` - генерация миграций
- `pnpm db:migrate` - применение миграций
- `pnpm db:studio` - запуск Drizzle Studio

### Storybook

- `pnpm storybook` - запуск Storybook
- `pnpm build-storybook` - сборка Storybook

## CI & Required checks

В проекте настроен GitHub Actions CI с тремя проверками: **Lint**, **Typecheck**, **Build**. Pull Request может быть смержен только если все проверки пройдены успешно.

### CI Pipeline

- **Lint** - проверка кода с помощью ESLint
- **Typecheck** - проверка типов с помощью svelte-check
- **Build** - сборка проекта для продакшена

### Настройки CI

- Node версия автоматически берётся из `.nvmrc`
- Пакетный менеджер pnpm используется через corepack
- Кэширование зависимостей для ускорения сборки
- Артефакт сборки сохраняется для диагностики

### Branch Protection

Ветка `main` защищена следующими правилами:

- Требуется Pull Request перед слиянием
- Обязательные статус-чеки: Lint, Typecheck, Build
- Все проверки должны пройти успешно

## Pre-commit хуки

Проект настроен с Husky и lint-staged для автоматической проверки кода перед коммитом:

- **ESLint** - проверка синтаксиса и стиля кода
- **Prettier** - автоматическое форматирование
- **svelte-check** - проверка типов Svelte

При ошибках в линте или типах коммит будет заблокирован.

### Как исправить ошибки линта/типов

1. **Автоматическое исправление:**

   ```bash
   pnpm lint --fix
   pnpm format
   ```

2. **Ручное исправление:**
   - Исправьте ошибки ESLint в указанных файлах
   - Убедитесь, что все типы корректны
   - Запустите `pnpm typecheck` для проверки

## Структура проекта

```
src/
├── lib/           # Общие библиотеки и утилиты
├── routes/        # Маршруты SvelteKit
├── app.html       # HTML шаблон
└── app.css        # Глобальные стили
```

## Использование алиаса @/

В проекте настроен алиас `@/` для директории `src/`:

```typescript
// Вместо
import { something } from '../../../lib/utils';

// Используйте
import { something } from '@/lib/utils';
```

Алиас работает в:

- TypeScript файлах
- Svelte компонентах
- Vite конфигурации
