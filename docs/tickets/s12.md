üéüÔ∏è Ticket: S1.2 –ë–∞–∑–æ–≤—ã–π CI (GitHub Actions): lint + typecheck + build

Goal: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å CI, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞ –∫–∞–∂–¥—ã–π PR –∏ push –≤ main –∑–∞–ø—É—Å–∫–∞–µ—Ç lint, typecheck, build –∏ –±–ª–æ–∫–∏—Ä—É–µ—Ç merge –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö.

Scope
‚Ä¢ In: –æ–¥–∏–Ω workflow –≤ .github/workflows/ci.yml, –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ pnpm, —á—Ç–µ–Ω–∏–µ Node –≤–µ—Ä—Å–∏–∏ –∏–∑ .nvmrc, –∞—Ä—Ç–µ—Ñ–∞–∫—Ç —Å–±–æ—Ä–∫–∏.
‚Ä¢ Out: –¥–µ–ø–ª–æ–π, e2e, –ø—Ä–µ–≤—å—é-–æ–∫—Ä—É–∂–µ–Ω–∏—è (–±—É–¥—É—Ç –ø–æ–∑–∂–µ).

‚∏ª

AC (Gherkin)
‚Ä¢ Given –æ—Ç–∫—Ä—ã—Ç Pull Request –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
When –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è GitHub Actions workflow
Then –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è job‚Äô—ã lint, typecheck, build –∏ –∫–∞–∂–¥—ã–π –ø—Ä–æ—Ö–æ–¥–∏—Ç —É—Å–ø–µ—à–Ω–æ.
‚Ä¢ Given –ª—é–±–æ–π –∏–∑ job‚Äô–æ–≤ –∑–∞–≤–µ—Ä—à–∏–ª—Å—è –æ—à–∏–±–∫–æ–π
Then PR –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–º–µ—Ä–∂–µ–Ω –≤ main (status checks required).
‚Ä¢ Given push –≤ –≤–µ—Ç–∫—É main
Then workflow –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∏ –ø—Ä–æ—Ö–æ–¥–∏—Ç —É—Å–ø–µ—à–Ω–æ.

‚∏ª

DoD
‚Ä¢ –í —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –µ—Å—Ç—å .github/workflows/ci.yml —Å —Ç—Ä–µ–º—è job‚Äô–∞–º–∏: lint, typecheck, build.
‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è actions/setup-node c node-version-file: .nvmrc –∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ pnpm.
‚Ä¢ –ö–æ–º–∞–Ω–¥—ã: pnpm install --frozen-lockfile, –∑–∞—Ç–µ–º pnpm lint, pnpm typecheck, pnpm build.
‚Ä¢ –ê—Ä—Ç–µ—Ñ–∞–∫—Ç —Å–±–æ—Ä–∫–∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –¥–ª—è –¥–µ–±–∞–≥–∞.
‚Ä¢ –í–∫–ª—é—á–µ–Ω–∞ –∑–∞—â–∏—Ç–∞ –≤–µ—Ç–∫–∏ main c required checks: lint, typecheck, build (Repo Settings ‚Üí Branches).
‚Ä¢ –í README.md/docs/SETUP.md –¥–æ–±–∞–≤–ª–µ–Ω–∞ —Å–µ–∫—Ü–∏—è ‚ÄúCI & Required checks‚Äù.

‚∏ª

–§–∞–π–ª—ã / –∏–∑–º–µ–Ω–µ–Ω–∏—è 1. .github/workflows/ci.yml

name: CI

on:
pull_request:
branches: [ main ]
paths-ignore: - '**/\*.md' - '.vscode/**'
push:
branches: [ main ]
paths-ignore: - '**/\*.md' - '.vscode/**'

concurrency:
group: ci-${{ github.ref }}
cancel-in-progress: true

env:
CI: true

jobs:

# –û–±—â–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è (reusable —á–µ—Ä–µ–∑ steps)

\_setup:
name: Setup
runs-on: ubuntu-latest
outputs:
cache-prefix: ${{ steps.derive-cache-prefix.outputs.prefix }}
steps: - name: Checkout
uses: actions/checkout@v4

      - name: Use Node from .nvmrc
        uses: actions/setup-node@v4
        with:
          node-version-file: '.nvmrc'
          cache: 'pnpm'

      - name: Enable corepack (pnpm)
        run: corepack enable

      - name: Derive cache prefix
        id: derive-cache-prefix
        run: echo "prefix=$(node -v)-pnpm" >> "$GITHUB_OUTPUT"

      - name: Install deps
        run: pnpm install --frozen-lockfile

lint:
name: Lint
needs: \_setup
runs-on: ubuntu-latest
steps: - uses: actions/checkout@v4 - uses: actions/setup-node@v4
with:
node-version-file: '.nvmrc'
cache: 'pnpm' - run: corepack enable - run: pnpm install --frozen-lockfile - name: eslint
run: pnpm lint

typecheck:
name: Typecheck
needs: \_setup
runs-on: ubuntu-latest
steps: - uses: actions/checkout@v4 - uses: actions/setup-node@v4
with:
node-version-file: '.nvmrc'
cache: 'pnpm' - run: corepack enable - run: pnpm install --frozen-lockfile - name: svelte-check
run: pnpm typecheck

build:
name: Build
needs: [lint, typecheck]
runs-on: ubuntu-latest
steps: - uses: actions/checkout@v4 - uses: actions/setup-node@v4
with:
node-version-file: '.nvmrc'
cache: 'pnpm' - run: corepack enable - run: pnpm install --frozen-lockfile - name: vite build
run: pnpm build - name: Upload build artifact (optional)
if: always()
uses: actions/upload-artifact@v4
with:
name: web-build
path: |
build
.svelte-kit
if-no-files-found: ignore

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –µ—Å–ª–∏ —Ö–æ—á–µ—à—å –±–æ–ª–µ–µ –±—ã—Å—Ç—Ä—ã–π CI, –º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å —Ç—Ä–æ–π–Ω–æ–µ pnpm install –Ω–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏—é —Å workspace-–∫—ç—à–µ–º, –Ω–æ –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã –∏ –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç–∏ –Ω–∞ —Å—Ç–∞—Ä—Ç–µ –æ–∫ –æ—Å—Ç–∞–≤–∏—Ç—å —Ç–∞–∫.

    2.	Branch protection (—Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä—É–∫–∞–º–∏ –≤ —Ä–µ–ø–æ-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö)
    ‚Ä¢	Settings ‚Üí Branches ‚Üí Branch protection rules ‚Üí main
    ‚Ä¢	Enable:
    ‚Ä¢	Require a pull request before merging
    ‚Ä¢	Require status checks to pass before merging
    ‚Ä¢	Required status checks: Lint, Typecheck, Build
    ‚Ä¢	(–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) Require linear history / signed commits
    3.	–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (–¥–æ–±–∞–≤–∏—Ç—å –±–ª–æ–∫)

    ‚Ä¢	docs/SETUP.md ‚Üí ‚ÄúCI & Required checks‚Äù:
    ‚Ä¢	‚Äú–í CI —Ç—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏: Lint, Typecheck, Build. PR —Å–º–µ—Ä–∂–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –≤—Å–µ –∑–µ–ª—ë–Ω—ã–µ.‚Äù
    ‚Ä¢	‚ÄúNode –≤–µ—Ä—Å–∏—è –±–µ—Ä—ë—Ç—Å—è –∏–∑ .nvmrc.‚Äù
    ‚Ä¢	‚Äú–ü–∞–∫–µ—Ç–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä pnpm —á–µ—Ä–µ–∑ corepack.‚Äù

‚∏ª

–ü–æ–¥—Å–∫–∞–∑–∫–∏ –ø–æ –ª—É—á—à–∏–º –ø—Ä–∞–∫—Ç–∏–∫–∞–º
‚Ä¢ –î–µ—Ä–∂–∏ job‚Äô—ã –∞—Ç–æ–º–∞—Ä–Ω—ã–º–∏ (–æ—Ç–¥–µ–ª—å–Ω—ã–µ lint, typecheck, build) ‚Äî –ø—Ä–æ—â–µ –≤–∫–ª—é—á–∞—Ç—å –∏—Ö –∫–∞–∫ required checks.
‚Ä¢ node-version-file: '.nvmrc' –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –µ–¥–∏–Ω—ã–π —Ä–∞–Ω—Ç–∞–π–º –ª–æ–∫–∞–ª—å–Ω–æ –∏ –≤ CI.
‚Ä¢ paths-ignore —ç–∫–æ–Ω–æ–º–∏—Ç –º–∏–Ω—É—Ç—ã –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–æ–Ω–Ω—ã—Ö PR‚Äô–∞—Ö.
‚Ä¢ –ê—Ä—Ç–µ—Ñ–∞–∫—Ç —Å–±–æ—Ä–∫–∏ –æ—Å—Ç–∞—ë—Ç—Å—è ‚Äú–Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π‚Äù –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ (–º–æ–∂–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å –ø–æ–∑–∂–µ).
